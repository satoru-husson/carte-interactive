<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Carte Interactive avec GeoJSON</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        #map { height: 500px; width: 100%; margin-bottom: 20px; }
        .capability { margin-bottom: 15px; }
        .sub-cap-btn { margin: 5px; }
    </style>
</head>
<body>
    <h1>Carte Interactive</h1>
    <div id="map"></div>
    <div id="capabilities-container"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
    // Initialisation de la carte centrée sur le monde
    const map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Chargement du GeoJSON des pays
    fetch('countries.geojson')
        .then(response => response.json())
        .then(data => {
            L.geoJSON(data, {
                style: {
                    color: "#3388ff",
                    weight: 1,
                    fillOpacity: 0.2
                },
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(feature.properties.ADMIN || "Pays");
                }
            }).addTo(map);
        })
        .catch(err => { alert("Impossible de charger countries.geojson"); });

    // Exemple de structure de capabilities et sous-capabilities
    const capabilitiesData = [
        {
            name: "Capability 1",
            subCapabilities: [
                { name: "Sous-cap 1", products: ["Produit A", "Produit B"] },
                { name: "Sous-cap 2", products: ["Produit C"] }
            ]
        },
        {
            name: "Capability 2",
            subCapabilities: [
                { name: "Sous-cap 3", products: ["Produit D"] },
                { name: "Sous-cap 4", products: ["Produit E", "Produit F"] }
            ]
        },
        // ... Ajoute en tout 6+ capabilities selon ton besoin
    ];
    let selectedSubCapabilities = [];

    // Génération des boutons
    function renderCapabilities() {
        const container = document.getElementById('capabilities-container');
        container.innerHTML = '';
        capabilitiesData.forEach((cap, i) => {
            const capDiv = document.createElement('div');
            capDiv.className = 'capability';
            capDiv.innerHTML = `<strong>${cap.name}</strong><br/>`;
            cap.subCapabilities.forEach((sub, j) => {
                const btn = document.createElement('button');
                btn.textContent = sub.name;
                btn.onclick = () => toggleSubCapability(cap.name, sub.name);
                btn.className = 'sub-cap-btn';
                capDiv.appendChild(btn);
            });
            container.appendChild(capDiv);
        });
    }

    function toggleSubCapability(capName, subName) {
        const key = `${capName}::${subName}`;
        const idx = selectedSubCapabilities.indexOf(key);
        if (idx === -1) {
            selectedSubCapabilities.push(key);
        } else {
            selectedSubCapabilities.splice(idx, 1);
        }
        // Tu peux ici ajouter une interaction avec la carte selon la sélection
        // Exemple : colorier un pays, afficher un popup, etc.
    }

    window.addEventListener('DOMContentLoaded', () => {
        renderCapabilities();
    });
    </script>
</body>
</html>
