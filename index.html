<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Carte Interactive avec GeoJSON</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        body { display: flex; }
        #sidebar { width: 18%; padding: 20px; }
        #map { height: 800px; width: 82%; margin-bottom: 20px; }
        .capability { margin-bottom: 15px; }
        .sub-cap-btn { margin: 5px; }
        .active { background: #3388ff; color: #fff; }
    </style>
</head>
<body>
    <div id="sidebar">
        <h2>Capabilities</h2>
        <div id="capabilities-container"></div>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
    // Initialisation de la carte centrée sur le monde
    const map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Chargement du GeoJSON des pays
    fetch('countries.geojson')
        .then(response => response.json())
        .then(data => {
            L.geoJSON(data, {
                style: {
                    color: "#3388ff",
                    weight: 1,
                    fillOpacity: 0.2
                },
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(feature.properties.ADMIN || "Pays");
                }
            }).addTo(map);
        })
        .catch(err => { alert("Impossible de charger countries.geojson"); });

    let capabilitiesData = [];
    let selectedCapability = null;

    function renderCapabilities() {
        const container = document.getElementById('capabilities-container');
        container.innerHTML = '';
        capabilitiesData.forEach((cap, i) => {
            const capBtn = document.createElement('button');
            capBtn.textContent = cap.name;
            capBtn.className = 'cap-btn' + (selectedCapability === i ? ' active' : '');
            capBtn.onclick = () => {
                selectedCapability = (selectedCapability === i) ? null : i;
                renderCapabilities();
            };
            container.appendChild(capBtn);

            // Affiche les subcapabilities si la capability est sélectionnée
            if (selectedCapability === i) {
                cap.subCapabilities.forEach((sub, j) => {
                    const subBtn = document.createElement('button');
                    subBtn.textContent = sub.name;
                    subBtn.className = 'sub-cap-btn';
                    subBtn.onclick = () => {
                        // Ajoute ici la logique pour gérer le clic sur une subcapability
                        alert(`Subcapability sélectionnée : ${sub.name}`);
                    };
                    container.appendChild(subBtn);
                });
            }
        });
    }

    window.addEventListener('DOMContentLoaded', () => {
        fetch('data.json')
            .then(r => r.json())
            .then(data => {
                console.log(data.capabilities); // <-- Ajoute ceci
                capabilitiesData = data.capabilities;
                renderCapabilities();
            });
    });
    </script>
</body>
</html>




